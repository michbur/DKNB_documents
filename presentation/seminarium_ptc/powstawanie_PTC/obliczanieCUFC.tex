
library(seqinr)
pliki=dir()
for(j in 1:length(pliki))
{
kat=pliki[j]
pliki1=dir(kat)
if(length(pliki1)!=0)
{
L=numeric(6)
A=numeric(6)
S=numeric(6)
G=numeric(4)
NRSCU=0
iff=0
ile=0

for(j1 in 1:length(pliki1))
{
plik=pliki1[j1]
if(c2s(s2c(plik)[(length(s2c(plik))-3):length(s2c(plik))])=="ffnn")
{
iff=1

genom=read.fasta(paste(kat,"/",plik,sep=""))
ile=ile+length(genom)
for(i in 1:length(genom))
{
sekw=genom[[i]]
f=count(sekw,3,by=3)
L[1]=L[1]+f["tta"]
L[2]=L[2]+f["ttg"]
L[3]=L[3]+f["cta"]
L[4]=L[4]+f["ctc"]
L[5]=L[5]+f["ctg"]
L[6]=L[6]+f["ctt"]
S[1]=S[1]+f["tca"]
S[2]=S[2]+f["tcc"]
S[3]=S[3]+f["tcg"]
S[4]=S[4]+f["tct"]
S[5]=S[5]+f["agc"]
S[6]=S[6]+f["agt"]
A[1]=A[1]+f["aga"]
A[2]=A[2]+f["agg"]
A[3]=A[3]+f["cga"]
A[4]=A[4]+f["cgc"]
A[5]=A[5]+f["cgg"]
A[6]=A[6]+f["cgt"]
G[1]=G[1]+f["gga"]
G[2]=G[2]+f["ggc"]
G[3]=G[3]+f["ggg"]
G[4]=G[4]+f["ggt"]
g1=((f["tta"]+f["ttg"])/(f["tta"]+f["ttg"]+f["cta"]+f["ctc"]+f["ctg"]+f["ctt"]))/4
g2=((f["tca"]+f["tcg"])/(f["tca"]+f["tcg"]+f["tcc"]+f["tct"]+f["agc"]+f["agt"]))/4
g3=((f["aga"]+f["cga"])/(f["aga"]+f["cga"]+f["agg"]+f["cgc"]+f["cgg"]+f["cgt"]))/4
g4=(f["gga"]/(f["gga"]+f["ggc"]+f["ggg"]+f["ggt"]))/4
NRSCU=sum(c(NRSCU,g1,g2,g3,g4),na.rm=TRUE)
}


}
}
if(iff==1)
{
zapisz=t(c(kat,L,S,A,G,NRSCU/ile))
write.table(zapisz,"wynikFC1dobre.txt",append=TRUE,col.names=FALSE,row.names=FALSE)
}
}

}

////////////////////////////////////////

library(seqinr)
pliki=dir()
for(j in 1:length(pliki))
{
kat=pliki[j]
pliki1=dir(kat)
if(length(pliki1)!=0)
{
L=numeric(6)
A=numeric(6)
S=numeric(6)
G=numeric(4)
NRSCU=0
iff=0
ile=0

for(j1 in 1:length(pliki1))
{
plik=pliki1[j1]
if(c2s(s2c(plik)[(length(s2c(plik))-2):length(s2c(plik))])==".no")
{
iff=1

genom=read.fasta(paste(kat,"/",plik,sep=""))
ile=ile+length(genom)
for(i in 1:length(genom))
{
sekw=genom[[i]]
f=count(sekw,3,by=3)
L[1]=L[1]+f["tta"]
L[2]=L[2]+f["ttg"]
L[3]=L[3]+f["cta"]
L[4]=L[4]+f["ctc"]
L[5]=L[5]+f["ctg"]
L[6]=L[6]+f["ctt"]
S[1]=S[1]+f["tca"]
S[2]=S[2]+f["tcc"]
S[3]=S[3]+f["tcg"]
S[4]=S[4]+f["tct"]
S[5]=S[5]+f["agc"]
S[6]=S[6]+f["agt"]
A[1]=A[1]+f["aga"]
A[2]=A[2]+f["agg"]
A[3]=A[3]+f["cga"]
A[4]=A[4]+f["cgc"]
A[5]=A[5]+f["cgg"]
A[6]=A[6]+f["cgt"]
G[1]=G[1]+f["gga"]
G[2]=G[2]+f["ggc"]
G[3]=G[3]+f["ggg"]
G[4]=G[4]+f["ggt"]
g1=((f["tta"]+f["ttg"])/(f["tta"]+f["ttg"]+f["cta"]+f["ctc"]+f["ctg"]+f["ctt"]))/4
g2=((f["tca"]+f["tcg"])/(f["tca"]+f["tcg"]+f["tcc"]+f["tct"]+f["agc"]+f["agt"]))/4
g3=((f["aga"]+f["cga"])/(f["aga"]+f["cga"]+f["agg"]+f["cgc"]+f["cgg"]+f["cgt"]))/4
g4=(f["gga"]/(f["gga"]+f["ggc"]+f["ggg"]+f["ggt"]))/4
NRSCU=sum(c(NRSCU,g1,g2,g3,g4),na.rm=TRUE)
}


}
}
if(iff==1)
{
zapisz=t(c(kat,L,S,A,G,NRSCU/ile))
write.table(zapisz,"wynikFC1dobrebezrib.txt",append=TRUE,col.names=FALSE,row.names=FALSE)
}
}

}
