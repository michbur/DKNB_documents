library(seqinr)
pliki=dir()
for(j in 1:length(pliki))
{
kat=pliki[j]
pliki1=dir(kat)
if(length(pliki1)!=0)
{
for(j1 in 1:length(pliki1))
{
plik=pliki1[j1]
if(c2s(s2c(plik)[(length(s2c(plik))-2):length(s2c(plik))])=="ffn")
{
grupa=numeric(6)

genom=read.fasta(paste(kat,"/",plik,sep=""))
avGC=matrix(numeric(60),6,10)
FCU=matrix(numeric(60),6,10)
NFCU=matrix(numeric(60),6,10)
FAU=matrix(numeric(60),6,10)
NFAU=matrix(numeric(60),6,10)

for(i in 1:length(genom))
{
sekw1=genom[[i]]
if(length(sekw1)>5000)
{
grupa[6]=grupa[6]+1
id=6
}
else
{
grupa[length(sekw1)%/%1000+1]=grupa[length(sekw1)%/%1000+1]+1
id=length(sekw1)%/%1000+1
}

start=0
for(x in seq(10,100,10))
{
punkt=length(sekw1)*x/100
punkt=punkt-punkt%%3
sekw=sekw1[start:punkt]
avGC[id,(x/10)]=avGC[id,(x/10)]+GC(sekw)
frak=count(sekw,3,by=3)
FCU[id,(x/10)]=FCU[id,(x/10)]+(frak["tta"]+frak["ttg"]+frak["tca"]+frak["tcg"]+frak["tat"]+frak["tac"]+
frak["tgt"]+frak["tgc"]+frak["tgg"]+frak["caa"]+frak["cag"]+frak["cga"]+
frak["aaa"]+frak["aag"]+frak["aga"]+frak["gaa"]+frak["gag"]+frak["gga"])/sum(frak)
g1=frak["tca"]/(frak["tca"]+frak["tct"])
g2=frak["tcg"]/(frak["tcg"]+frak["tcc"])
g3=frak["cga"]/(frak["cga"]+frak["cgt"])
g4=frak["gga"]/(frak["gga"]+frak["ggt"])
g5=frak["ttg"]/(frak["ttg"]+frak["ctt"]+frak["cta"])
NFCU[id,(x/10)]=NFCU[id,(x/10)]+sum(c(g1,g2,g3,g4,g5),na.rm=TRUE)/5
bial=translate(sekw)
fb=count(bial,1,alphabet=s2c("VTPNMIHFDAYWSRQLKGEC"))
FAU[id,(x/10)]=FAU[id,(x/10)]+(fb["C"]+fb["Q"]+fb["E"]+fb["K"]+fb["W"]+fb["Y"])/sum(fb)
g1=(fb["K"]+fb["Y"])/(fb["K"]+fb["Y"]+fb["F"]+fb["N"])
g2=(fb["C"]+fb["E"]+fb["Q"]+frak["tca"]+frak["tcg"])/(fb["C"]+
 fb["E"]+fb["Q"]+fb["S"]+fb["D"]+fb["H"]+fb["T"]+fb["V"])
NFAU[id,(x/10)]=NFAU[id,(x/10)]+sum(c(g1,g2),na.rm=TRUE)/2
start=punkt+1
}
}
zapisz=t(c(kat,FCU[1,]/grupa[1],FCU[2,]/grupa[2],FCU[3,]/grupa[3]
,FCU[4,]/grupa[4],FCU[5,]/grupa[5],FCU[6,]/grupa[6],FAU[1,]/grupa[1],FAU[2,]/grupa[2]
,FAU[3,]/grupa[3]
,FAU[4,]/grupa[4],FAU[5,]/grupa[5],FAU[6,]/grupa[6],NFCU[1,]/grupa[1],NFCU[2,]/grupa[2]
,NFCU[3,]/grupa[3]
,NFCU[4,]/grupa[4],NFCU[5,]/grupa[5],NFCU[6,]/grupa[6],NFAU[1,]/grupa[1],NFAU[2,]/grupa[2]
,NFAU[3,]/grupa[3]
,NFAU[4,]/grupa[4],NFAU[5,]/grupa[5],NFAU[6,]/grupa[6],avGC[1,]/grupa[1],avGC[2,]/grupa[2]
,avGC[3,]/grupa[3]
,avGC[4,]/grupa[4],avGC[5,]/grupa[5],avGC[6,]/grupa[6]))
write.table(zapisz,"wynikFCgrupa.txt",append=TRUE,col.names=FALSE,row.names=FALSE)
}
}
}
}

