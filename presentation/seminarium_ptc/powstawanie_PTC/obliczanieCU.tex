library(seqinr)
pliki=dir()
for(j in 1:length(pliki))
{
kat=pliki[j]
pliki1=dir(kat)
if(length(pliki1)!=0)
{

iff=0
avGC=0
oGC=numeric(2)
ile=0
FCU=c()
FAU=c()
NFCU=c()
NFAU=c()

for(j1 in 1:length(pliki1))
{
plik=pliki1[j1]
if(c2s(s2c(plik)[(length(s2c(plik))-3):length(s2c(plik))])=="ffnn")
{

iff=1
genom=read.fasta(paste(kat,"/",plik,sep=""))
ile=ile+length(genom)
for( i in 1:length(genom))
{
sekw=genom[[i]]
avGC=avGC+GC(sekw)
oGC[1]=oGC[1]+count(sekw,1)["g"]+count(sekw,1)["c"]
oGC[2]=oGC[2]+length(sekw)
frak=count(sekw,3,by=3)
FCU=c(FCU,(frak["tta"]+frak["ttg"]+frak["tca"]+frak["tcg"]+frak["tat"]+frak["tac"]+
frak["tgt"]+frak["tgc"]+frak["tgg"]+frak["caa"]+frak["cag"]+frak["cga"]+
frak["aaa"]+frak["aag"]+frak["aga"]+frak["gaa"]+frak["gag"]+frak["gga"])/sum(frak))
g1=frak["tca"]/(frak["tca"]+frak["tct"])
g2=frak["tcg"]/(frak["tcg"]+frak["tcc"])
g3=frak["cga"]/(frak["cga"]+frak["cgt"])
g4=frak["gga"]/(frak["gga"]+frak["ggt"])
g5=frak["ttg"]/(frak["ttg"]+frak["ctt"]+frak["cta"])
NFCU=c(NFCU,sum(c(g1,g2,g3,g4,g5),na.rm=TRUE)/5)
bial=translate(sekw)
fb=count(bial,1,alphabet=s2c("VTPNMIHFDAYWSRQLKGEC"))
FAU=c(FAU,(fb["C"]+fb["Q"]+fb["E"]+fb["K"]+fb["W"]+fb["Y"])/sum(fb))
g1=(fb["K"]+fb["Y"])/(fb["K"]+fb["Y"]+fb["F"]+fb["N"])
g2=(fb["C"]+fb["E"]+fb["Q"]+frak["tca"]+frak["tcg"])/(fb["C"]+
 fb["E"]+fb["Q"]+fb["S"]+fb["D"]+fb["H"]+fb["T"]+fb["V"])
NFAU=c(NFAU,sum(c(g1,g2),na.rm=TRUE)/2)
}

}
}
if(iff==1)
{
library(stats)
sp1=cor.test(FCU,FAU)
sp2=cor.test(NFCU,NFAU)
zapisz=t(c(kat,mean(FCU),mean(FAU),mean(NFCU),mean(NFAU),sp1$estimate[[1]],sp2$estimate[[1]],avGC/ile,(oGC[1]/oGC[2])[[1]]))
write.table(zapisz,"wynikFCdobre.txt",append=TRUE,col.names=FALSE,row.names=FALSE)
}
}
}

/////////////////////////////////
library(seqinr)
pliki=dir()
for(j in 1:length(pliki))
{
kat=pliki[j]
pliki1=dir(kat)
if(length(pliki1)!=0)
{

iff=0
avGC=0
oGC=numeric(2)
ile=0
FCU=c()
FAU=c()
NFCU=c()
NFAU=c()

for(j1 in 1:length(pliki1))
{
plik=pliki1[j1]
if(c2s(s2c(plik)[(length(s2c(plik))-2):length(s2c(plik))])==".no")
{

iff=1
genom=read.fasta(paste(kat,"/",plik,sep=""))
ile=ile+length(genom)
for( i in 1:length(genom))
{
sekw=genom[[i]]
avGC=avGC+GC(sekw)
oGC[1]=oGC[1]+count(sekw,1)["g"]+count(sekw,1)["c"]
oGC[2]=oGC[2]+length(sekw)
frak=count(sekw,3,by=3)
FCU=c(FCU,(frak["tta"]+frak["ttg"]+frak["tca"]+frak["tcg"]+frak["tat"]+frak["tac"]+
frak["tgt"]+frak["tgc"]+frak["tgg"]+frak["caa"]+frak["cag"]+frak["cga"]+
frak["aaa"]+frak["aag"]+frak["aga"]+frak["gaa"]+frak["gag"]+frak["gga"])/sum(frak))
g1=frak["tca"]/(frak["tca"]+frak["tct"])
g2=frak["tcg"]/(frak["tcg"]+frak["tcc"])
g3=frak["cga"]/(frak["cga"]+frak["cgt"])
g4=frak["gga"]/(frak["gga"]+frak["ggt"])
g5=frak["ttg"]/(frak["ttg"]+frak["ctt"]+frak["cta"])
NFCU=c(NFCU,sum(c(g1,g2,g3,g4,g5),na.rm=TRUE)/5)
bial=translate(sekw)
fb=count(bial,1,alphabet=s2c("VTPNMIHFDAYWSRQLKGEC"))
FAU=c(FAU,(fb["C"]+fb["Q"]+fb["E"]+fb["K"]+fb["W"]+fb["Y"])/sum(fb))
g1=(fb["K"]+fb["Y"])/(fb["K"]+fb["Y"]+fb["F"]+fb["N"])
g2=(fb["C"]+fb["E"]+fb["Q"]+frak["tca"]+frak["tcg"])/(fb["C"]+
 fb["E"]+fb["Q"]+fb["S"]+fb["D"]+fb["H"]+fb["T"]+fb["V"])
NFAU=c(NFAU,sum(c(g1,g2),na.rm=TRUE)/2)
}

}
}
if(iff==1)
{
library(stats)
sp1=cor.test(FCU,FAU)
sp2=cor.test(NFCU,NFAU)
zapisz=t(c(kat,mean(FCU),mean(FAU),mean(NFCU),mean(NFAU),sp1$estimate[[1]],sp2$estimate[[1]],avGC/ile,(oGC[1]/oGC[2])[[1]]))
write.table(zapisz,"wynikFCdobrebezrib.txt",append=TRUE,col.names=FALSE,row.names=FALSE)
}
}
}
